import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";var path_string_p = function(s76) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part77 = M0.path_p(s76);if (or_part77!==false) {var if_res60 = or_part77;} else {if (M0.string_p(s76)!==false) {var or_part78 = M0.__rjs_quoted__.relative_path_p(s76);if (or_part78!==false) {var if_res58 = or_part78;} else {var if_res58 = M0.__rjs_quoted__.absolute_path_p(s76);}var if_res59 = if_res58;} else {var if_res59 = false;}var if_res60 = if_res59;}return if_res60;};var bsbs = M0.string($rjs_core.Char.charFromCodepoint(92),$rjs_core.Char.charFromCodepoint(92));var normal_case_path = function(s79) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part80 = M0.__rjs_quoted__.path_for_some_system_p(s79);if (or_part80!==false) {var if_res61 = or_part80;} else {var if_res61 = path_string_p(s79);}if (if_res61!==false) {var if_res62 = M0.rvoid();} else {var if_res62 = M0.raise_argument_error($rjs_core.Symbol.make("normal-path-case"),$rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),s79);}if_res62;if (M0.__rjs_quoted__.path_for_some_system_p(s79)!==false) {var if_res63 = M0.eq_p(M0.__rjs_quoted__.path_convention_type(s79),$rjs_core.Symbol.make("windows"));} else {var if_res63 = M0.eq_p(M0.system_type(),$rjs_core.Symbol.make("windows"));}if (if_res63!==false) {if (M0.string_p(s79)!==false) {var if_res64 = s79;} else {var if_res64 = M0.__rjs_quoted__.bytes__gt_string_by_locale(M0.__rjs_quoted__.path__gt_bytes(s79));}var str81 = if_res64;if (M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",str81)!==false) {if (M0.string_p(s79)!==false) {var if_res65 = M0.string__gt_path(s79);} else {var if_res65 = s79;}var if_res67 = if_res65;} else {var s82 = M0.__rjs_quoted__.string_locale_downcase(str81);if (M0.__rjs_quoted__.regexp_match_p("/[\\/\\][. ]+[\\/\\]*$/",s82)!==false) {var if_res66 = s82;} else {var if_res66 = M0.__rjs_quoted__.regexp_replace_times_("/[ .]+([\\/\\]*)$/",s82,$rjs_core.UString.make("\\1"));}var if_res67 = M0.__rjs_quoted__.bytes__gt_path(M0.__rjs_quoted__.string__gt_bytes_by_locale(M0.__rjs_quoted__.regexp_replace_times_("/\\//",if_res66,bsbs)),$rjs_core.Symbol.make("windows"));}var if_res69 = if_res67;} else {if (M0.string_p(s79)!==false) {var if_res68 = M0.string__gt_path(s79);} else {var if_res68 = s79;}var if_res69 = if_res68;}return if_res69;};var check_extension_call = function(s83, sfx84, who85, sep86, trust_sep_p87) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part90 = M0.__rjs_quoted__.path_for_some_system_p(s83);if (or_part90!==false) {var if_res70 = or_part90;} else {var if_res70 = path_string_p(s83);}if (M0.not(if_res70)!==false) {var if_res76 = M0.values($rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),0);} else {var or_part91 = M0.string_p(sfx84);if (or_part91!==false) {var if_res71 = or_part91;} else {var if_res71 = M0.bytes_p(sfx84);}if (M0.not(if_res71)!==false) {var if_res75 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),1);} else {var or_part92 = trust_sep_p87;if (or_part92!==false) {var if_res73 = or_part92;} else {var or_part93 = M0.string_p(sep86);if (or_part93!==false) {var if_res72 = or_part93;} else {var if_res72 = M0.bytes_p(sep86);}var if_res73 = if_res72;}if (M0.not(if_res73)!==false) {var if_res74 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),2);} else {var if_res74 = M0.values(false,false);}var if_res75 = if_res74;}var if_res76 = if_res75;}var let_result77 = if_res76;var err_msg88 = let_result77.getAt(0);var err_index89 = let_result77.getAt(1);if (err_msg88!==false) {if (trust_sep_p87!==false) {var if_res78 = M0.raise_argument_error(who85,err_msg88,err_index89,s83,sfx84);} else {var if_res78 = M0.raise_argument_error(who85,err_msg88,err_index89,s83,sfx84,sep86);}var if_res79 = if_res78;} else {var if_res79 = M0.rvoid();}if_res79;var let_result80 = M0.__rjs_quoted__.split_path(s83);var base94 = let_result80.getAt(0);var name95 = let_result80.getAt(1);var dir_p96 = let_result80.getAt(2);if (M0.not(base94)!==false) {var if_res81 = M0.raise_mismatch_error(who85,$rjs_core.UString.make("cannot add an extension to a root path: "),s83);} else {var if_res81 = M0.rvoid();}if_res81;return M0.values(base94,name95);};var path_adjust_extension = function(name97, sep98, rest_bytes99, s100, sfx101, trust_sep_p102) {if (arguments.length!==6) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result82 = check_extension_call(s100,sfx101,name97,sep98,trust_sep_p102);var base103 = let_result82.getAt(0);var name104 = let_result82.getAt(1);var bs105 = M0.__rjs_quoted__.path_element__gt_bytes(name104);var finish106 = function(i107, sep108, i2109) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp87 = M0.__rjs_quoted__.subbytes(bs105,0,i107);if (M0.string_p(sep108)!==false) {var if_res86 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sep108,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res86 = sep108;}var temp85 = rest_bytes99(bs105,i2109);if (M0.string_p(sfx101)!==false) {var if_res84 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sfx101,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res84 = sfx101;}var temp88 = M0.__rjs_quoted__.bytes_append(temp87,if_res86,temp85,if_res84);if (M0.__rjs_quoted__.path_for_some_system_p(s100)!==false) {var if_res83 = M0.__rjs_quoted__.path_convention_type(s100);} else {var if_res83 = M0.__rjs_quoted__.system_path_convention_type();}return M0.__rjs_quoted__.bytes__gt_path_element(temp88,if_res83);};var loop111 = function(i112) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(i112)!==false) {var if_res91 = finish106(M0.bytes_length(bs105),$rjs_core.Bytes.fromIntArray([]),M0.bytes_length(bs105));} else {var i113 = M0.sub1(i112);if (M0.not(M0.zero_p(i113))!==false) {var if_res89 = M0.eq_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46)),M0.bytes_ref(bs105,i113));} else {var if_res89 = false;}if (if_res89!==false) {var if_res90 = finish106(i113,sep98,M0.add1(i113));} else {var if_res90 = loop111(i113);}var if_res91 = if_res90;}return if_res91;};var new_name110 = loop111(M0.bytes_length(bs105));if (M0.__rjs_quoted__.path_for_some_system_p(base103)!==false) {var if_res92 = M0.__rjs_quoted__.build_path(base103,new_name110);} else {var if_res92 = new_name110;}return if_res92;};var path_replace_extension = function(s114, sfx115) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.Symbol.make("path-replace-extension"),$rjs_core.Bytes.fromIntArray([]),function(bs116, i117) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return $rjs_core.Bytes.fromIntArray([]);},s114,sfx115,true);};var cl93 = function(s118, sfx119) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.Symbol.make("path-add-extension"),$rjs_core.Bytes.fromIntArray([95]),M0.__rjs_quoted__.subbytes,s118,sfx119,true);};var cl94 = function(s120, sfx121, sep122) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.Symbol.make("path-add-extension"),sep122,M0.__rjs_quoted__.subbytes,s120,sfx121,false);};var path_add_extension = $rjs_core.attachProcedureArity(function() {var fixed_lam95 = {'2':cl93,'3':cl94}[arguments.length];if (fixed_lam95!==undefined) {return fixed_lam95.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var reroot_path = function(p123, root124) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part125 = path_string_p(p123);if (or_part125!==false) {var if_res96 = or_part125;} else {var if_res96 = M0.__rjs_quoted__.path_for_some_system_p(p123);}if (if_res96!==false) {var if_res97 = M0.rvoid();} else {var if_res97 = M0.raise_argument_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),0,p123,root124);}if_res97;var let_result98 = M0.values();var or_part126 = path_string_p(root124);if (or_part126!==false) {var if_res99 = or_part126;} else {var if_res99 = M0.__rjs_quoted__.path_for_some_system_p(root124);}if (if_res99!==false) {var if_res100 = M0.rvoid();} else {var if_res100 = M0.raise_argument_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),1,p123,root124);}if_res100;var let_result101 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(p123)!==false) {var if_res102 = M0.__rjs_quoted__.path_convention_type(p123);} else {var if_res102 = M0.__rjs_quoted__.system_path_convention_type();}var conv127 = if_res102;var or_part128 = M0.__rjs_quoted__.complete_path_p(p123);if (or_part128!==false) {var if_res103 = or_part128;} else {var if_res103 = M0.eq_p(M0.__rjs_quoted__.system_path_convention_type(),conv127);}if (if_res103!==false) {var if_res104 = M0.rvoid();} else {var if_res104 = M0.raise_arguments_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("path is not complete and not the platform's convention"),$rjs_core.UString.make("path"),p123,$rjs_core.UString.make("platform convention type"),M0.__rjs_quoted__.system_path_convention_type());}if_res104;var let_result105 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(root124)!==false) {var if_res106 = M0.__rjs_quoted__.path_convention_type(root124);} else {var if_res106 = M0.__rjs_quoted__.system_path_convention_type();}if (M0.eq_p(if_res106,conv127)!==false) {var if_res107 = M0.rvoid();} else {var if_res107 = M0.raise_arguments_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("given paths use different conventions"),$rjs_core.UString.make("path"),p123,$rjs_core.UString.make("root path"),root124);}if_res107;var let_result108 = M0.values();if (M0.__rjs_quoted__.complete_path_p(p123)!==false) {var if_res109 = p123;} else {var if_res109 = M0.__rjs_quoted__.path__gt_complete_path(p123);}var c_p129 = normal_case_path(M0.__rjs_quoted__.cleanse_path(if_res109));var bstr130 = M0.__rjs_quoted__.path__gt_bytes(c_p129);if (M0.eq_p(conv127,$rjs_core.Symbol.make("unix"))!==false) {if (M0.bytes_eq__p(bstr130,$rjs_core.Bytes.fromIntArray([47]))!==false) {if (M0.__rjs_quoted__.path_for_some_system_p(root124)!==false) {var if_res110 = root124;} else {var if_res110 = M0.string__gt_path(root124);}var if_res111 = if_res110;} else {var if_res111 = M0.__rjs_quoted__.build_path(root124,M0.__rjs_quoted__.bytes__gt_path(M0.__rjs_quoted__.subbytes(M0.__rjs_quoted__.path__gt_bytes(c_p129),1),conv127));}var if_res118 = if_res111;} else {if (M0.eq_p(conv127,$rjs_core.Symbol.make("windows"))!==false) {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\[a-z]:/",bstr130)!==false) {var if_res116 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr130,4,5),$rjs_core.Bytes.fromIntArray([92]),M0.__rjs_quoted__.subbytes(bstr130,6));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr130)!==false) {var if_res115 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr130,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr130)!==false) {var if_res114 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr130,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\/",bstr130)!==false) {var if_res113 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([85,78,67,92]),M0.__rjs_quoted__.subbytes(bstr130,2));} else {if (M0.__rjs_quoted__.regexp_match_p("/^[a-z]:/",bstr130)!==false) {var if_res112 = M0.__rjs_quoted__.bytes_append(M0.__rjs_quoted__.subbytes(bstr130,0,1),M0.__rjs_quoted__.subbytes(bstr130,2));} else {var if_res112 = M0.rvoid();}var if_res113 = if_res112;}var if_res114 = if_res113;}var if_res115 = if_res114;}var if_res116 = if_res115;}var if_res117 = M0.__rjs_quoted__.build_path(root124,M0.__rjs_quoted__.bytes__gt_path(if_res116,conv127));} else {var if_res117 = M0.rvoid();}var if_res118 = if_res117;}return if_res118;};var __rjs_quoted__ = {};export { __rjs_quoted__,reroot_path,path_add_extension,path_replace_extension,normal_case_path,path_string_p };