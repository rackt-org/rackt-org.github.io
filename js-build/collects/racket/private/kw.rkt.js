import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result375 = M0.make_struct_type_property($rjs_core.Symbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result375.getAt(0);var keyword_impersonator_p = let_result375.getAt(1);var keyword_impersonator_ref = let_result375.getAt(2);var keyword_procedure_impersonator_of = function(v808) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v808)!==false) {var if_res376 = keyword_impersonator_ref(v808)(v808);} else {var if_res376 = false;}return if_res376;};var let_result377 = M0.make_struct_type($rjs_core.Symbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result377.getAt(0);var mk_kw_proc = let_result377.getAt(1);var keyword_procedure_p = let_result377.getAt(2);var keyword_procedure_ref = let_result377.getAt(3);var keyword_procedure_set_bang_ = let_result377.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result378 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result378.getAt(0);var make_km = let_result378.getAt(1);var keyword_method_p = let_result378.getAt(2);var km_ref = let_result378.getAt(3);var km_set_bang_ = let_result378.getAt(4);var generate_arity_string = function(proc809) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result379 = procedure_keywords(proc809);var req810 = let_result379.getAt(0);var allowed811 = let_result379.getAt(1);var a812 = M0.procedure_arity(proc809);var keywords_desc813 = function(opt815, req816) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp385 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req816))!==false) {var if_res384 = M0.format($rjs_core.UString.make("an ~aargument"),opt815);} else {var if_res384 = M0.format($rjs_core.UString.make("~aarguments"),opt815);}if (M0.null_p(M0.cdr(req816))!==false) {var if_res383 = $rjs_core.UString.make("");} else {var if_res383 = $rjs_core.UString.make("s");}var tmp817 = M0.length(req816);if (M0.equal_p(tmp817,1)!==false) {var if_res382 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req816));} else {if (M0.equal_p(tmp817,2)!==false) {var if_res381 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req816),M0.cadr(req816));} else {var loop818 = function(req819) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req819))!==false) {var if_res380 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req819));} else {var if_res380 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req819),loop818(M0.cdr(req819)));}return if_res380;};var if_res381 = loop818(req816);}var if_res382 = if_res381;}return M0.format(temp385,if_res384,if_res383,if_res382);};var method_adjust814 = function(a820) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part821 = okm_p(proc809);if (or_part821!==false) {var if_res386 = or_part821;} else {var if_res386 = keyword_method_p(proc809);}if (if_res386!==false) {if (M0.zero_p(a820)!==false) {var if_res387 = 0;} else {var if_res387 = M0.sub1(a820);}var if_res388 = if_res387;} else {var if_res388 = a820;}return if_res388;};if (M0.number_p(a812)!==false) {var a822 = method_adjust814(a812);var if_res395 = M0.format($rjs_core.UString.make("~a"),a822);} else {if (M0.arity_at_least_p(a812)!==false) {var a823 = method_adjust814(M0.arity_at_least_value(a812));var if_res394 = M0.format($rjs_core.UString.make("at least ~a"),a823);} else {var if_res394 = $rjs_core.UString.make("a different number");}var if_res395 = if_res394;}if (M0.null_p(req810)!==false) {var if_res393 = $rjs_core.UString.make("");} else {var if_res393 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc813($rjs_core.UString.make(""),req810));}if (allowed811!==false) {var loop825 = function(req826, allowed827) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req826)!==false) {var if_res390 = allowed827;} else {if (M0.eq_p(M0.car(req826),M0.car(allowed827))!==false) {var if_res389 = loop825(M0.cdr(req826),M0.cdr(allowed827));} else {var if_res389 = M0.cons(M0.car(allowed827),loop825(req826,M0.cdr(allowed827)));}var if_res390 = if_res389;}return if_res390;};var others824 = loop825(req810,allowed811);if (M0.null_p(others824)!==false) {var if_res391 = $rjs_core.UString.make("");} else {var if_res391 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc813($rjs_core.UString.make("optional "),others824));}var if_res392 = if_res391;} else {var if_res392 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res395,if_res393,if_res392);};var let_result396 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result396.getAt(0);var make_optional_keyword_procedure = let_result396.getAt(1);var okp_p = let_result396.getAt(2);var okp_ref = let_result396.getAt(3);var okp_set_bang_ = let_result396.getAt(4);var let_result397 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result397.getAt(0);var make_optional_keyword_method = let_result397.getAt(1);var okm_p = let_result397.getAt(2);var okm_ref = let_result397.getAt(3);var okm_set_bang_ = let_result397.getAt(4);var let_result398 = M0.make_struct_type_property($rjs_core.Symbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result398.getAt(0);var named_keyword_procedure_p = let_result398.getAt(1);var keyword_procedure_name_plus_fail = let_result398.getAt(2);var let_result400 = M0.make_struct_type_property($rjs_core.Symbol.make("procedure"),function(v828, info_l829) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v828)!==false) {var if_res399 = M0.make_struct_field_accessor(M0.list_ref(info_l829,3),v828);} else {var if_res399 = false;}return if_res399;});var prop_procedure_accessor = let_result400.getAt(0);var procedure_accessor_p = let_result400.getAt(1);var procedure_accessor_ref = let_result400.getAt(2);var let_result401 = M0.make_struct_type_property($rjs_core.Symbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result401.getAt(0);var new_procedure_p = let_result401.getAt(1);var new_procedure_ref = let_result401.getAt(2);var let_result402 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v830) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v830,0);})));var struct_keyword_procedure_impersonator = let_result402.getAt(0);var make_kpp = let_result402.getAt(1);var keyword_procedure_impersonator_p = let_result402.getAt(2);var kpp_ref = let_result402.getAt(3);var kpp_set_bang_ = let_result402.getAt(4);var let_result403 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v831) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v831,0);})));var struct_keyword_method_impersonator = let_result403.getAt(0);var make_kmp = let_result403.getAt(1);var keyword_method_impersonator_p = let_result403.getAt(2);var kmp_ref = let_result403.getAt(3);var kmp_set_bang_ = let_result403.getAt(4);var let_result404 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v832) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v832,0);})));var struct_okpp = let_result404.getAt(0);var make_optional_keyword_procedure_impersonator = let_result404.getAt(1);var okpp_p = let_result404.getAt(2);var okpp_ref = let_result404.getAt(3);var okpp_set_bang_ = let_result404.getAt(4);var let_result405 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v833) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v833,0);})));var struct_okmp = let_result405.getAt(0);var make_optional_keyword_method_impersonator = let_result405.getAt(1);var okmp_p = let_result405.getAt(2);var okmp_ref = let_result405.getAt(3);var okmp_set_bang_ = let_result405.getAt(4);var let_result406 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result406.getAt(0);var make_kp_by_ae = let_result406.getAt(1);var kp_by_ae_p = let_result406.getAt(2);var kp_by_ae_ref = let_result406.getAt(3);var kp_by_ae_set_bang_ = let_result406.getAt(4);var let_result407 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result407.getAt(0);var make_km_by_ae = let_result407.getAt(1);var km_by_ae_p = let_result407.getAt(2);var km_by_ae_ref = let_result407.getAt(3);var km_by_ae_set_bang_ = let_result407.getAt(4);var let_result408 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result408.getAt(0);var make_kpi_by_ae = let_result408.getAt(1);var kpi_by_ae_p = let_result408.getAt(2);var kpi_by_ae_ref = let_result408.getAt(3);var kpi_by_ae_set_bang_ = let_result408.getAt(4);var let_result409 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result409.getAt(0);var make_kmi_by_ae = let_result409.getAt(1);var kmi_by_ae_p = let_result409.getAt(2);var kmi_by_ae_ref = let_result409.getAt(3);var kmi_by_ae_set_bang_ = let_result409.getAt(4);var make_required = function(name834, fail_proc835, method_p836, impersonator_p837) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part843 = name834;if (or_part843!==false) {var if_res413 = or_part843;} else {var if_res413 = $rjs_core.Symbol.make("unknown");}if (impersonator_p837!==false) {if (method_p836!==false) {var if_res410 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res410 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res412 = if_res410;} else {if (method_p836!==false) {var if_res411 = struct_keyword_method_by_arity_error;} else {var if_res411 = struct_keyword_procedure_by_arity_error;}var if_res412 = if_res411;}var let_result414 = M0.make_struct_type(if_res413,if_res412,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name834,fail_proc835))),M0.current_inspector(),fail_proc835);var s_838 = let_result414.getAt(0);var mk839 = let_result414.getAt(1);var __p840 = let_result414.getAt(2);var __ref841 = let_result414.getAt(3);var __set_bang_842 = let_result414.getAt(4);return mk839;};var cl415 = function(proc844) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name845 = M0.object_name(proc844);var plain_proc846 = $rjs_core.attachProcedureArity(function(...args847418) {var args847 = $rjs_core.Pair.listFromArray(args847418);return M0.apply(proc844,M0.rnull,M0.rnull,args847);});if (M0.symbol_p(proc_name845)!==false) {var if_res419 = M0.__rjs_quoted__.procedure_rename(plain_proc846,proc_name845);} else {var if_res419 = plain_proc846;}return make_keyword_procedure(proc844,if_res419);};var cl416 = function(proc848, plain_proc849) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc848)!==false) {var if_res420 = M0.procedure_arity_mask(proc848);} else {var if_res420 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res420),proc848,M0.rnull,false,plain_proc849);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam417 = {'1':cl415,'2':cl416}[arguments.length];if (fixed_lam417!==undefined) {return fixed_lam417.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc850, kws851, kw_vals852, normal_args853, ...normal_argss854421) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss854 = $rjs_core.Pair.listFromArray(normal_argss854421);var type_error855 = function(what856, which857) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.Symbol.make("keyword-apply"),what856,which857,proc850,kws851,kw_vals852,normal_args853,normal_argss854);};if (M0.procedure_p(proc850)!==false) {var if_res422 = M0.rvoid();} else {var if_res422 = type_error855($rjs_core.UString.make("procedure?"),0);}if_res422;var loop858 = function(ks859) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks859)!==false) {var if_res429 = M0.rvoid();} else {var or_part860 = M0.not(M0.pair_p(ks859));if (or_part860!==false) {var if_res423 = or_part860;} else {var if_res423 = M0.not(M0.keyword_p(M0.car(ks859)));}if (if_res423!==false) {var if_res428 = type_error855($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks859))!==false) {var if_res427 = M0.rvoid();} else {var or_part861 = M0.not(M0.pair_p(M0.cdr(ks859)));if (or_part861!==false) {var if_res424 = or_part861;} else {var if_res424 = M0.not(M0.keyword_p(M0.cadr(ks859)));}if (if_res424!==false) {var if_res426 = loop858(M0.cdr(ks859));} else {if (M0.keyword_lt__p(M0.car(ks859),M0.cadr(ks859))!==false) {var if_res425 = loop858(M0.cdr(ks859));} else {var if_res425 = type_error855($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res426 = if_res425;}var if_res427 = if_res426;}var if_res428 = if_res427;}var if_res429 = if_res428;}return if_res429;};loop858(kws851);if (M0.list_p(kw_vals852)!==false) {var if_res430 = M0.rvoid();} else {var if_res430 = type_error855($rjs_core.UString.make("list?"),2);}if_res430;if (M0.__eq_(M0.length(kws851),M0.length(kw_vals852))!==false) {var if_res431 = M0.rvoid();} else {var if_res431 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws851),$rjs_core.UString.make("value list length"),M0.length(kw_vals852),$rjs_core.UString.make("keyword list"),kws851,$rjs_core.UString.make("value list"),kw_vals852);}if_res431;var loop863 = function(normal_argss864, pos865) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss864))!==false) {var l866 = M0.car(normal_argss864);if (M0.list_p(l866)!==false) {var if_res432 = l866;} else {var if_res432 = type_error855($rjs_core.UString.make("list?"),pos865);}var if_res433 = if_res432;} else {var if_res433 = M0.cons(M0.car(normal_argss864),loop863(M0.cdr(normal_argss864),M0.add1(pos865)));}return if_res433;};var normal_args862 = loop863(M0.cons(normal_args853,normal_argss854),3);if (M0.null_p(kws851)!==false) {var if_res434 = M0.apply(proc850,normal_args862);} else {var if_res434 = M0.apply(keyword_procedure_extract_by_method(kws851,2+M0.length(normal_args862),proc850,0),kws851,kw_vals852,normal_args862);}return if_res434;});var procedure_keywords = function(p867) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p867)!==false) {var if_res439 = M0.values(keyword_procedure_required(p867),keyword_procedure_allowed(p867));} else {if (M0.procedure_p(p867)!==false) {if (new_procedure_p(p867)!==false) {var v868 = new_procedure_ref(p867);if (M0.procedure_p(v868)!==false) {var if_res436 = procedure_keywords(v868);} else {var a869 = procedure_accessor_ref(p867);if (a869!==false) {var if_res435 = procedure_keywords(a869(p867));} else {var if_res435 = M0.values(M0.rnull,M0.rnull);}var if_res436 = if_res435;}var if_res437 = if_res436;} else {var if_res437 = M0.values(M0.rnull,M0.rnull);}var if_res438 = if_res437;} else {var if_res438 = M0.raise_argument_error($rjs_core.Symbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p867);}var if_res439 = if_res438;}return if_res439;};var missing_kw = $rjs_core.attachProcedureArity(function(proc870, ...args871440) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args871 = $rjs_core.Pair.listFromArray(args871440);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc870,0),M0.rnull,M0.rnull,args871);});var check_kw_args = function(p872, kws873) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop874 = function(kws875, required876, allowed877) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws875)!==false) {if (M0.null_p(required876)!==false) {var if_res441 = M0.values(false,false);} else {var if_res441 = M0.values(M0.car(required876),false);}var if_res450 = if_res441;} else {if (M0.pair_p(required876)!==false) {var if_res442 = M0.eq_p(M0.car(required876),M0.car(kws875));} else {var if_res442 = false;}if (if_res442!==false) {var temp445 = M0.cdr(kws875);var temp444 = M0.cdr(required876);if (allowed877!==false) {var if_res443 = M0.cdr(allowed877);} else {var if_res443 = false;}var if_res449 = loop874(temp445,temp444,if_res443);} else {if (M0.not(allowed877)!==false) {var if_res448 = loop874(M0.cdr(kws875),required876,false);} else {if (M0.pair_p(allowed877)!==false) {if (M0.eq_p(M0.car(allowed877),M0.car(kws875))!==false) {var if_res446 = loop874(M0.cdr(kws875),required876,M0.cdr(allowed877));} else {var if_res446 = loop874(kws875,required876,M0.cdr(allowed877));}var if_res447 = if_res446;} else {var if_res447 = M0.values(false,M0.car(kws875));}var if_res448 = if_res447;}var if_res449 = if_res448;}var if_res450 = if_res449;}return if_res450;};return loop874(kws873,keyword_procedure_required(p872),keyword_procedure_allowed(p872));};var make_keyword_checker = function(req_kws878, allowed_kws879, arity_mask880) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws879)!==false) {if (M0.null_p(req_kws878)!==false) {var if_res453 = function(kws881, a882) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res451 = M0.bitwise_bit_set_p(arity_mask880,a882);} else {var if_res451 = false;}return if_res451;};} else {var if_res453 = function(kws883, a884) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws878,kws883)!==false) {var if_res452 = M0.bitwise_bit_set_p(arity_mask880,a884);} else {var if_res452 = false;}return if_res452;};}var if_res466 = if_res453;} else {if (M0.null_p(allowed_kws879)!==false) {var if_res465 = function(kws885, a886) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws885)!==false) {var if_res454 = M0.bitwise_bit_set_p(arity_mask880,a886);} else {var if_res454 = false;}return if_res454;};} else {if (M0.null_p(req_kws878)!==false) {var if_res464 = function(kws887, a888) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws887,allowed_kws879)!==false) {var if_res455 = M0.bitwise_bit_set_p(arity_mask880,a888);} else {var if_res455 = false;}return if_res455;};} else {if (M0.list_p(req_kws878)!==false) {if (M0.list_p(allowed_kws879)!==false) {var if_res456 = M0.eq_p(M0.length(req_kws878),M0.length(allowed_kws879));} else {var if_res456 = false;}var if_res457 = if_res456;} else {var if_res457 = false;}if (if_res457!==false) {var if_res463 = function(kws889, a890) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop891 = function(kws892, req_kws893) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws893)!==false) {var if_res460 = M0.null_p(kws892);} else {if (M0.null_p(kws892)!==false) {var if_res459 = false;} else {if (M0.eq_p(M0.car(kws892),M0.car(req_kws893))!==false) {var if_res458 = loop891(M0.cdr(kws892),M0.cdr(req_kws893));} else {var if_res458 = false;}var if_res459 = if_res458;}var if_res460 = if_res459;}return if_res460;};if (loop891(kws889,req_kws878)!==false) {var if_res461 = M0.bitwise_bit_set_p(arity_mask880,a890);} else {var if_res461 = false;}return if_res461;};} else {var if_res463 = function(kws894, a895) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws878,kws894,allowed_kws879)!==false) {var if_res462 = M0.bitwise_bit_set_p(arity_mask880,a895);} else {var if_res462 = false;}return if_res462;};}var if_res464 = if_res463;}var if_res465 = if_res464;}var if_res466 = if_res465;}return if_res466;};var subset_p = function(l1896, l2897) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1896)!==false) {var if_res469 = true;} else {if (M0.null_p(l2897)!==false) {var if_res468 = false;} else {if (M0.eq_p(M0.car(l1896),M0.car(l2897))!==false) {var if_res467 = subset_p(M0.cdr(l1896),M0.cdr(l2897));} else {var if_res467 = subset_p(l1896,M0.cdr(l2897));}var if_res468 = if_res467;}var if_res469 = if_res468;}return if_res469;};var subsets_p = function(l1898, l2899, l3900) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1898)!==false) {var if_res474 = subset_p(l2899,l3900);} else {if (M0.null_p(l2899)!==false) {var if_res473 = false;} else {if (M0.null_p(l3900)!==false) {var if_res472 = false;} else {var v2901 = M0.car(l2899);if (M0.eq_p(M0.car(l1898),v2901)!==false) {var if_res471 = subsets_p(M0.cdr(l1898),M0.cdr(l2899),M0.cdr(l3900));} else {if (M0.eq_p(v2901,M0.car(l3900))!==false) {var if_res470 = subsets_p(l1898,M0.cdr(l2899),M0.cdr(l3900));} else {var if_res470 = subsets_p(l1898,l2899,M0.cdr(l3900));}var if_res471 = if_res470;}var if_res472 = if_res471;}var if_res473 = if_res472;}var if_res474 = if_res473;}return if_res474;};var keyword_procedure_extract_by_method = function(kws902, n903, p904, method_n905) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p904)!==false) {var if_res475 = keyword_procedure_checker(p904)(kws902,n903);} else {var if_res475 = false;}if (if_res475!==false) {var if_res505 = keyword_procedure_proc(p904);} else {if (M0.not(keyword_procedure_p(p904))!==false) {if (M0.procedure_p(p904)!==false) {if (new_procedure_p(p904)!==false) {var a908 = procedure_accessor_ref(p904);if (a908!==false) {var if_res476 = a908(p904);} else {var if_res476 = false;}var if_res477 = if_res476;} else {var if_res477 = false;}var or_part907 = if_res477;if (or_part907!==false) {var if_res480 = or_part907;} else {var or_part909 = M0.procedure_extract_target(p904);if (or_part909!==false) {var if_res479 = or_part909;} else {if (new_procedure_p(p904)!==false) {var if_res478 = $rjs_core.Symbol.make("method");} else {var if_res478 = false;}var if_res479 = if_res478;}var if_res480 = if_res479;}var if_res481 = if_res480;} else {var if_res481 = false;}var if_res482 = if_res481;} else {var if_res482 = false;}var p2906 = if_res482;if (p2906!==false) {if (M0.eq_p(p2906,$rjs_core.Symbol.make("method"))!==false) {var p3910 = keyword_procedure_extract_by_method(kws902,M0.add1(n903),new_procedure_ref(p904),M0.add1(method_n905));var if_res484 = $rjs_core.attachProcedureArity(function(kws911, kw_args912, ...args913483) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args913 = $rjs_core.Pair.listFromArray(args913483);return M0.apply(p3910,kws911,kw_args912,M0.cons(p904,args913));});} else {var if_res484 = keyword_procedure_extract_by_method(kws902,n903,p2906,method_n905);}var if_res504 = if_res484;} else {var if_res504 = $rjs_core.attachProcedureArity(function(kws914, kw_args915, ...args916485) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args916 = $rjs_core.Pair.listFromArray(args916485);if (keyword_procedure_p(p904)!==false) {var if_res486 = check_kw_args(p904,kws914);} else {var if_res486 = M0.values(false,M0.car(kws914));}var let_result487 = if_res486;var missing_kw917 = let_result487.getAt(0);var extra_kw918 = let_result487.getAt(1);var or_part923 = keyword_method_p(p904);if (or_part923!==false) {var if_res488 = or_part923;} else {var if_res488 = okm_p(p904);}if (if_res488!==false) {var if_res489 = 1;} else {var if_res489 = 0;}var method_n922 = method_n905+if_res489;if (M0.__gt__eq_(n903,method_n922)!==false) {var if_res490 = n903-method_n922;} else {var if_res490 = n903;}var n919 = if_res490;if (M0.null_p(args916)!==false) {var if_res491 = M0.null_p(kws914);} else {var if_res491 = false;}if (if_res491!==false) {var if_res492 = $rjs_core.UString.make("");} else {var if_res492 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v924) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v924);},args916),M0.map(function(kw925, kw_arg926) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw925,kw_arg926);},kws914,kw_args915)));}var args_str920 = if_res492;var proc_name921 = function(p927) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p927)!==false) {var if_res493 = M0.car(keyword_procedure_name_plus_fail(p927));} else {var if_res493 = false;}var or_part928 = if_res493;if (or_part928!==false) {var if_res495 = or_part928;} else {var or_part929 = M0.object_name(p927);if (or_part929!==false) {var if_res494 = or_part929;} else {var if_res494 = p927;}var if_res495 = if_res494;}return if_res495;};var or_part930 = extra_kw918;if (or_part930!==false) {var if_res502 = or_part930;} else {var if_res502 = missing_kw917;}if (if_res502!==false) {var if_res503 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res503 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw918!==false) {if (keyword_procedure_p(p904)!==false) {var if_res497 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name921(p904),extra_kw918,args_str920);} else {if (M0.procedure_p(p904)!==false) {var if_res496 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name921(p904),args_str920);} else {var if_res496 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p904,args_str920);}var if_res497 = if_res496;}var if_res501 = if_res497;} else {if (missing_kw917!==false) {var if_res500 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name921(p904),missing_kw917,args_str920);} else {var temp499 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n919-2)!==false) {var if_res498 = $rjs_core.UString.make("");} else {var if_res498 = $rjs_core.UString.make("s");}var if_res500 = M0.format(temp499,n919-2,if_res498,proc_name921(p904),args_str920);}var if_res501 = if_res500;}return M0.raise(if_res503(if_res501,M0.current_continuation_marks()));});}var if_res505 = if_res504;}return if_res505;};var keyword_procedure_extract = function(p931, kws932, n933) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws932,n933,p931,0);};var cl506 = function(proc934, arity935, req_kw936, allowed_kw937, name938) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity"),proc934,arity935,false,name938,req_kw936,allowed_kw937);};var cl507 = function(proc939, arity940, req_kw941, allowed_kw942) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity"),proc939,arity940,false,false,req_kw941,allowed_kw942);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam508 = {'5':cl506,'4':cl507}[arguments.length];if (fixed_lam508!==undefined) {return fixed_lam508.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl509 = function(proc943, mask944, req_kw945, allowed_kw946, name947) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity-mask"),proc943,false,mask944,name947,req_kw945,allowed_kw946);};var cl510 = function(proc948, mask949, req_kw950, allowed_kw951) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity-mask"),proc948,false,mask949,false,req_kw950,allowed_kw951);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam511 = {'5':cl509,'4':cl510}[arguments.length];if (fixed_lam511!==undefined) {return fixed_lam511.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who952, proc953, arity954, mask955, name956, req_kw957, allowed_kw958) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc953)!==false) {var if_res512 = okp_ref(proc953,0);} else {var if_res512 = proc953;}var p960 = if_res512;if (arity954!==false) {var if_res513 = M0.__rjs_quoted__.procedure_reduce_arity(p960,arity954);} else {var if_res513 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p960,mask955,name956);}var plain_proc959 = if_res513;var sorted_p961 = function(kws962) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop963 = function(kws964) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws964)!==false) {var if_res516 = true;} else {if (M0.null_p(M0.cdr(kws964))!==false) {var if_res515 = true;} else {if (M0.keyword_lt__p(M0.car(kws964),M0.cadr(kws964))!==false) {var if_res514 = loop963(M0.cdr(kws964));} else {var if_res514 = false;}var if_res515 = if_res514;}var if_res516 = if_res515;}return if_res516;};return loop963(kws962);};if (M0.list_p(req_kw957)!==false) {if (M0.andmap(M0.keyword_p,req_kw957)!==false) {var if_res517 = sorted_p961(req_kw957);} else {var if_res517 = false;}var if_res518 = if_res517;} else {var if_res518 = false;}if (if_res518!==false) {var if_res521 = M0.rvoid();} else {var temp520 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part965 = arity954;if (or_part965!==false) {var if_res519 = or_part965;} else {var if_res519 = mask955;}var if_res521 = M0.raise_argument_error(who952,temp520,2,proc953,if_res519,req_kw957,allowed_kw958);}if_res521;if (allowed_kw958!==false) {if (M0.list_p(allowed_kw958)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw958)!==false) {var if_res522 = sorted_p961(allowed_kw958);} else {var if_res522 = false;}var if_res523 = if_res522;} else {var if_res523 = false;}if (if_res523!==false) {var if_res526 = M0.rvoid();} else {var temp525 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part966 = arity954;if (or_part966!==false) {var if_res524 = or_part966;} else {var if_res524 = mask955;}var if_res526 = M0.raise_argument_error(who952,temp525,3,proc953,if_res524,req_kw957,allowed_kw958);}if_res526;if (subset_p(req_kw957,allowed_kw958)!==false) {var if_res527 = M0.rvoid();} else {var if_res527 = M0.raise_arguments_error(who952,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw958,$rjs_core.UString.make("required keywords"),req_kw957);}var if_res528 = if_res527;} else {var if_res528 = M0.rvoid();}if_res528;var let_result529 = procedure_keywords(proc953);var old_req967 = let_result529.getAt(0);var old_allowed968 = let_result529.getAt(1);if (subset_p(old_req967,req_kw957)!==false) {var if_res530 = M0.rvoid();} else {var if_res530 = M0.raise_arguments_error(who952,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req967,$rjs_core.UString.make("requested required keywords"),req_kw957);}if_res530;if (old_allowed968!==false) {if (subset_p(req_kw957,old_allowed968)!==false) {var if_res531 = M0.rvoid();} else {var if_res531 = M0.raise_arguments_error(who952,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed968,$rjs_core.UString.make("requested required keywords"),req_kw957);}if_res531;var or_part969 = M0.not(allowed_kw958);if (or_part969!==false) {var if_res532 = or_part969;} else {var if_res532 = subset_p(allowed_kw958,old_allowed968);}if (if_res532!==false) {var if_res533 = M0.rvoid();} else {var if_res533 = M0.raise_arguments_error(who952,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed968,$rjs_core.UString.make("requested allowed keywords"),allowed_kw958);}var if_res534 = if_res533;} else {var if_res534 = M0.rvoid();}if_res534;if (M0.null_p(allowed_kw958)!==false) {var if_res542 = plain_proc959;} else {var or_part971 = mask955;if (or_part971!==false) {var if_res535 = or_part971;} else {var if_res535 = arity__gt_mask(arity954);}var mask970 = if_res535;var new_mask972 = M0.arithmetic_shift(mask970,2);var kw_checker973 = make_keyword_checker(req_kw957,allowed_kw958,new_mask972);var proc974 = normalize_proc(proc953);var new_kw_proc975 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc974),new_mask972);if (M0.null_p(req_kw957)!==false) {if (okm_p(proc974)!==false) {var if_res536 = make_optional_keyword_method;} else {var if_res536 = make_optional_keyword_procedure;}var if_res541 = if_res536(kw_checker973,new_kw_proc975,req_kw957,allowed_kw958,plain_proc959);} else {if (named_keyword_procedure_p(proc974)!==false) {var if_res539 = M0.car(keyword_procedure_name_plus_fail(proc974));} else {var if_res539 = false;}var or_part976 = if_res539;if (or_part976!==false) {var if_res540 = or_part976;} else {var if_res540 = M0.object_name(proc974);}var temp538 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask970,1));var or_part977 = okm_p(proc974);if (or_part977!==false) {var if_res537 = or_part977;} else {var if_res537 = keyword_method_p(proc974);}var if_res541 = make_required(if_res540,temp538,if_res537,false)(kw_checker973,new_kw_proc975,req_kw957,allowed_kw958);}var if_res542 = if_res541;}return if_res542;};var arity__gt_mask = function(a978) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a978)!==false) {var if_res548 = M0.arithmetic_shift(1,a978);} else {if (M0.arity_at_least_p(a978)!==false) {var if_res547 = M0.__rjs_quoted__.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a978))));} else {if (M0.list_p(a978)!==false) {var loop979 = function(mask980, l981) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l981)!==false) {var if_res545 = mask980;} else {var a982 = M0.car(l981);var or_part983 = M0.exact_nonnegative_integer_p(a982);if (or_part983!==false) {var if_res543 = or_part983;} else {var if_res543 = M0.arity_at_least_p(a982);}if (if_res543!==false) {var if_res544 = loop979(M0.__rjs_quoted__.bitwise_ior(mask980,arity__gt_mask(a982)),M0.cdr(l981));} else {var if_res544 = false;}var if_res545 = if_res544;}return if_res545;};var if_res546 = loop979(0,a978);} else {var if_res546 = false;}var if_res547 = if_res546;}var if_res548 = if_res547;}return if_res548;};var cl549 = function(proc985, arity986, name987) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc985)!==false) {var let_result552 = procedure_keywords(proc985);var req988 = let_result552.getAt(0);var allows989 = let_result552.getAt(1);if (M0.pair_p(req988)!==false) {var if_res553 = M0.not(M0.null_p(arity986));} else {var if_res553 = false;}var if_res554 = if_res553;} else {var if_res554 = false;}if (if_res554!==false) {var if_res556 = M0.raise_arguments_error($rjs_core.Symbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc985);} else {if (okm_p(proc985)!==false) {var if_res555 = M0.__rjs_quoted__.procedure__gt_method(proc985);} else {var if_res555 = proc985;}var if_res556 = M0.__rjs_quoted__.procedure_reduce_arity(if_res555,arity986,name987);}return if_res556;};var cl550 = function(proc990, arity991) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc990,arity991,false);};var procedure_reduce_arity984 = $rjs_core.attachProcedureArity(function() {var fixed_lam551 = {'3':cl549,'2':cl550}[arguments.length];if (fixed_lam551!==undefined) {return fixed_lam551.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity984;var cl557 = function(proc993, mask994, name995) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc993)!==false) {var let_result560 = procedure_keywords(proc993);var req996 = let_result560.getAt(0);var allows997 = let_result560.getAt(1);if (M0.pair_p(req996)!==false) {var if_res561 = M0.not(M0.eqv_p(mask994,0));} else {var if_res561 = false;}var if_res562 = if_res561;} else {var if_res562 = false;}if (if_res562!==false) {var if_res564 = M0.raise_arguments_error($rjs_core.Symbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc993);} else {if (okm_p(proc993)!==false) {var if_res563 = M0.__rjs_quoted__.procedure__gt_method(proc993);} else {var if_res563 = proc993;}var if_res564 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res563,mask994,name995);}return if_res564;};var cl558 = function(proc998, mask999) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc998,mask999,false);};var procedure_reduce_arity992 = $rjs_core.attachProcedureArity(function() {var fixed_lam559 = {'3':cl557,'2':cl558}[arguments.length];if (fixed_lam559!==undefined) {return fixed_lam559.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity992;var procedure__gt_method1000 = function(proc1001) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1002 = normalize_proc(proc1001);if (keyword_procedure_p(proc1002)!==false) {if (okm_p(proc1002)!==false) {var if_res567 = proc1002;} else {if (keyword_method_p(proc1002)!==false) {var if_res566 = proc1002;} else {if (okp_p(proc1002)!==false) {var if_res565 = make_optional_keyword_method(keyword_procedure_checker(proc1002),keyword_procedure_proc(proc1002),keyword_procedure_required(proc1002),keyword_procedure_allowed(proc1002),okp_ref(proc1002,0));} else {var name_plus_fail1003 = keyword_procedure_name_plus_fail(proc1002);var mk1004 = make_required(M0.car(name_plus_fail1003),M0.cdr(name_plus_fail1003),true,false);var if_res565 = mk1004(keyword_procedure_checker(proc1002),keyword_procedure_proc(proc1002),keyword_procedure_required(proc1002),keyword_procedure_allowed(proc1002));}var if_res566 = if_res565;}var if_res567 = if_res566;}var if_res568 = if_res567;} else {var if_res568 = M0.__rjs_quoted__.procedure__gt_method(proc1002);}return if_res568;};var new_procedure__gt_method = procedure__gt_method1000;var procedure_rename1005 = function(proc1006, name1007) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1006)!==false) {var if_res569 = M0.symbol_p(name1007);} else {var if_res569 = false;}if (M0.not(if_res569)!==false) {var if_res572 = M0.__rjs_quoted__.procedure_rename(proc1006,name1007);} else {if (okp_p(proc1006)!==false) {if (okm_p(proc1006)!==false) {var if_res570 = make_optional_keyword_method;} else {var if_res570 = make_optional_keyword_procedure;}var if_res571 = if_res570(keyword_procedure_checker(proc1006),keyword_procedure_proc(proc1006),keyword_procedure_required(proc1006),keyword_procedure_allowed(proc1006),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1006,0),name1007));} else {var name_plus_fail1008 = keyword_procedure_name_plus_fail(proc1006);var mk1009 = make_required(name1007,M0.cdr(name_plus_fail1008),keyword_method_p(proc1006),false);var if_res571 = mk1009(keyword_procedure_checker(proc1006),keyword_procedure_proc(proc1006),keyword_procedure_required(proc1006),keyword_procedure_allowed(proc1006));}var if_res572 = if_res571;}return if_res572;};var new_procedure_rename = procedure_rename1005;var chaperone_procedure1010 = $rjs_core.attachProcedureArity(function(proc1011, wrap_proc1012, ...props1013573) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1013 = $rjs_core.Pair.listFromArray(props1013573);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.Symbol.make("chaperone-procedure"),proc1011,wrap_proc1012,props1013);});var new_chaperone_procedure = chaperone_procedure1010;var unsafe_chaperone_procedure1014 = $rjs_core.attachProcedureArity(function(proc1015, wrap_proc1016, ...props1017574) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1017 = $rjs_core.Pair.listFromArray(props1017574);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.Symbol.make("unsafe-chaperone-procedure"),proc1015,wrap_proc1016,props1017);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1014;var impersonate_procedure1018 = $rjs_core.attachProcedureArity(function(proc1019, wrap_proc1020, ...props1021575) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1021 = $rjs_core.Pair.listFromArray(props1021575);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.Symbol.make("impersonate-procedure"),proc1019,wrap_proc1020,props1021);});var new_impersonate_procedure = impersonate_procedure1018;var unsafe_impersonate_procedure1022 = $rjs_core.attachProcedureArity(function(proc1023, wrap_proc1024, ...props1025576) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1025 = $rjs_core.Pair.listFromArray(props1025576);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.Symbol.make("unsafe-impersonate-procedure"),proc1023,wrap_proc1024,props1025);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1022;var chaperone_procedure_times_1026 = $rjs_core.attachProcedureArity(function(proc1027, wrap_proc1028, ...props1029577) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1029 = $rjs_core.Pair.listFromArray(props1029577);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.Symbol.make("chaperone-procedure"),proc1027,wrap_proc1028,props1029);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1026;var impersonate_procedure_times_1030 = $rjs_core.attachProcedureArity(function(proc1031, wrap_proc1032, ...props1033578) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1033 = $rjs_core.Pair.listFromArray(props1033578);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.Symbol.make("impersonate-procedure"),proc1031,wrap_proc1032,props1033);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1030;var do_chaperone_procedure = function(is_impersonator_p1034, self_arg_p1035, chaperone_procedure1036, name1037, proc1038, wrap_proc1039, props1040) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1041 = normalize_proc(proc1038);var n_wrap_proc1042 = normalize_proc(wrap_proc1039);var or_part1043 = M0.not(keyword_procedure_p(n_proc1041));if (or_part1043!==false) {var if_res580 = or_part1043;} else {var or_part1044 = M0.not(M0.procedure_p(wrap_proc1039));if (or_part1044!==false) {var if_res579 = or_part1044;} else {var if_res579 = bad_props_p(props1040);}var if_res580 = if_res579;}if (if_res580!==false) {var if_res644 = M0.apply(chaperone_procedure1036,proc1038,wrap_proc1039,props1040);} else {chaperone_arity_match_checking(self_arg_p1035,name1037,proc1038,wrap_proc1039,props1040);var p1046 = keyword_procedure_proc(n_wrap_proc1042);if (self_arg_p1035!==false) {var cl581 = $rjs_core.attachProcedureArity(function(self_proc1047, kws1048, args1049, ...rest1050586) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1050 = $rjs_core.Pair.listFromArray(rest1050586);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1046,kws1048,args1049,self_proc1047,rest1050);},$rjs_core.attachProcedureArity(function(...results1051587) {var results1051 = $rjs_core.Pair.listFromArray(results1051587);var len1052 = M0.length(results1051);var alen1053 = M0.length(rest1050);if (M0.__lt_(len1052,alen1053+1)!==false) {var if_res588 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1053+1,$rjs_core.UString.make("received number of results"),len1052,$rjs_core.UString.make("wrapper procedure"),wrap_proc1039);} else {var if_res588 = M0.rvoid();}if_res588;var num_extra1054 = len1052-(alen1053+1);var new_args1055 = M0.list_ref(results1051,num_extra1054);if (M0.list_p(new_args1055)!==false) {var if_res589 = M0.__eq_(M0.length(new_args1055),M0.length(args1049));} else {var if_res589 = false;}if (if_res589!==false) {var if_res593 = M0.rvoid();} else {var temp592 = $rjs_core.Symbol.make("keyword procedure chaperone");var temp591 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1052,alen1053)!==false) {var if_res590 = $rjs_core.UString.make("");} else {var if_res590 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res593 = M0.raise_arguments_error(temp592,M0.format(temp591,if_res590),$rjs_core.UString.make("first result"),new_args1055,$rjs_core.UString.make("wrapper procedure"),wrap_proc1039);}if_res593;M0.for_each(function(kw1056, new_arg1057, arg1058) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1034!==false) {var if_res595 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1057,arg1058)!==false) {var if_res594 = M0.rvoid();} else {var if_res594 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1056),$rjs_core.UString.make("result"),new_arg1057,$rjs_core.UString.make("wrapper procedure"),wrap_proc1039);}var if_res595 = if_res594;}return if_res595;},kws1048,new_args1055,args1049);var tmp1059 = num_extra1054;if (M0.equal_p(tmp1059,0)!==false) {var if_res598 = M0.apply(M0.values,kws1048,results1051);} else {if (M0.equal_p(tmp1059,1)!==false) {var if_res597 = M0.apply(M0.values,M0.car(results1051),kws1048,M0.cdr(results1051));} else {var loop1060 = function(results1061, c1062) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1062)!==false) {var if_res596 = M0.cons(kws1048,results1061);} else {var if_res596 = M0.cons(M0.car(results1061),loop1060(M0.cdr(results1061),M0.sub1(c1062)));}return if_res596;};var if_res597 = M0.apply(M0.values,loop1060(results1051,num_extra1054));}var if_res598 = if_res597;}return if_res598;}));});var cl582 = $rjs_core.attachProcedureArity(function(...other1063599) {var other1063 = $rjs_core.Pair.listFromArray(other1063599);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res619 = $rjs_core.attachProcedureArity(function() {var fixed_lam583 = {}[arguments.length];if (fixed_lam583!==undefined) {return fixed_lam583.apply(null,arguments);} else {if (M0.__gt__eq_(cl581.length,1)!==false) {var if_res585 = cl581.apply(null,arguments);} else {if (true!==false) {var if_res584 = cl582.apply(null,arguments);} else {var if_res584 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res585 = if_res584;}return if_res585;}},[M0.make_arity_at_least(0)]);} else {var cl600 = $rjs_core.attachProcedureArity(function(kws1064, args1065, ...rest1066605) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1066 = $rjs_core.Pair.listFromArray(rest1066605);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1046,kws1064,args1065,rest1066);},$rjs_core.attachProcedureArity(function(...results1067606) {var results1067 = $rjs_core.Pair.listFromArray(results1067606);var len1068 = M0.length(results1067);var alen1069 = M0.length(rest1066);if (M0.__lt_(len1068,alen1069+1)!==false) {var if_res607 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1069+1,$rjs_core.UString.make("received number of results"),len1068,$rjs_core.UString.make("wrapper procedure"),wrap_proc1039);} else {var if_res607 = M0.rvoid();}if_res607;var num_extra1070 = len1068-(alen1069+1);var new_args1071 = M0.list_ref(results1067,num_extra1070);if (M0.list_p(new_args1071)!==false) {var if_res608 = M0.__eq_(M0.length(new_args1071),M0.length(args1065));} else {var if_res608 = false;}if (if_res608!==false) {var if_res612 = M0.rvoid();} else {var temp611 = $rjs_core.Symbol.make("keyword procedure chaperone");var temp610 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1068,alen1069)!==false) {var if_res609 = $rjs_core.UString.make("");} else {var if_res609 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res612 = M0.raise_arguments_error(temp611,M0.format(temp610,if_res609),$rjs_core.UString.make("first result"),new_args1071,$rjs_core.UString.make("wrapper procedure"),wrap_proc1039);}if_res612;M0.for_each(function(kw1072, new_arg1073, arg1074) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1034!==false) {var if_res614 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1073,arg1074)!==false) {var if_res613 = M0.rvoid();} else {var if_res613 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1072),$rjs_core.UString.make("result"),new_arg1073,$rjs_core.UString.make("wrapper procedure"),wrap_proc1039);}var if_res614 = if_res613;}return if_res614;},kws1064,new_args1071,args1065);var tmp1075 = num_extra1070;if (M0.equal_p(tmp1075,0)!==false) {var if_res617 = M0.apply(M0.values,kws1064,results1067);} else {if (M0.equal_p(tmp1075,1)!==false) {var if_res616 = M0.apply(M0.values,M0.car(results1067),kws1064,M0.cdr(results1067));} else {var loop1076 = function(results1077, c1078) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1078)!==false) {var if_res615 = M0.cons(kws1064,results1077);} else {var if_res615 = M0.cons(M0.car(results1077),loop1076(M0.cdr(results1077),M0.sub1(c1078)));}return if_res615;};var if_res616 = M0.apply(M0.values,loop1076(results1067,num_extra1070));}var if_res617 = if_res616;}return if_res617;}));});var cl601 = $rjs_core.attachProcedureArity(function(...other1079618) {var other1079 = $rjs_core.Pair.listFromArray(other1079618);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res619 = $rjs_core.attachProcedureArity(function() {var fixed_lam602 = {}[arguments.length];if (fixed_lam602!==undefined) {return fixed_lam602.apply(null,arguments);} else {if (M0.__gt__eq_(cl600.length,1)!==false) {var if_res604 = cl600.apply(null,arguments);} else {if (true!==false) {var if_res603 = cl601.apply(null,arguments);} else {var if_res603 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res604 = if_res603;}return if_res604;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1045 = if_res619;var wrap1082 = function(proc1083, n_proc1084) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1084,proc1083))!==false) {var if_res620 = new_procedure_p(proc1083);} else {var if_res620 = false;}if (if_res620!==false) {var v1085 = new_procedure_ref(proc1083);if (M0.exact_integer_p(v1085)!==false) {var acc1086 = procedure_accessor_ref(proc1083);var if_res636 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1083,acc1086,function(self1087, sub_proc1088) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result621 = wrap1082(sub_proc1088,normalize_proc(sub_proc1088));var f1089 = let_result621.getAt(0);var acc1090 = let_result621.getAt(1);return f1089;}),acc1086);} else {if (is_impersonator_p1034!==false) {var if_res635 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res635 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1084)!==false) {var if_res634 = chaperone_procedure1036(proc1083,wrap_proc1039);} else {var if_res634 = proc1083;}var new_kw_proc1091 = if_res635(if_res634,new_procedure_ref,function(self1092, proc1093) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1034!==false) {var if_res633 = new_impersonate_procedure;} else {var if_res633 = new_chaperone_procedure;}if (self_arg_p1035!==false) {var if_res632 = $rjs_core.attachProcedureArity(function(proc_self1094, kws1095, kw_args1096, self1097, ...args1098622) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1098 = $rjs_core.Pair.listFromArray(args1098622);var len1099 = M0.length(args1098);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1045,proc_self1094,kws1095,kw_args1096,args1098);},$rjs_core.attachProcedureArity(function(...results1100623) {var results1100 = $rjs_core.Pair.listFromArray(results1100623);var r_len1101 = M0.length(results1100);var list_take1102 = function(l1103, n1104) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1104)!==false) {var if_res624 = M0.rnull;} else {var if_res624 = M0.cons(M0.car(l1103),list_take1102(M0.cdr(l1103),M0.sub1(n1104)));}return if_res624;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.Symbol.make("proc-self")))!==false) {var if_res625 = M0.__eq_(r_len1101,2+len1099);} else {var if_res625 = false;}if (if_res625!==false) {var if_res626 = M0.apply(M0.values,M0.cadr(results1100),self1097,M0.cddr(results1100));} else {var skip1105 = r_len1101-len1099;var if_res626 = M0.apply(M0.values,M0.append(list_take1102(results1100,skip1105-2),M0.list(M0.list_ref(results1100,M0.sub1(skip1105)),self1097),M0.__rjs_quoted__.list_tail(results1100,skip1105)));}return if_res626;}));});} else {var if_res632 = $rjs_core.attachProcedureArity(function(kws1106, kw_args1107, self1108, ...args1109627) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1109 = $rjs_core.Pair.listFromArray(args1109627);var len1110 = M0.length(args1109);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1045,kws1106,kw_args1107,args1109);},$rjs_core.attachProcedureArity(function(...results1111628) {var results1111 = $rjs_core.Pair.listFromArray(results1111628);var r_len1112 = M0.length(results1111);var list_take1113 = function(l1114, n1115) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1115)!==false) {var if_res629 = M0.rnull;} else {var if_res629 = M0.cons(M0.car(l1114),list_take1113(M0.cdr(l1114),M0.sub1(n1115)));}return if_res629;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res630 = M0.__eq_(r_len1112,2+len1110);} else {var if_res630 = false;}if (if_res630!==false) {var if_res631 = M0.apply(M0.values,M0.cadr(results1111),self1108,M0.cddr(results1111));} else {var skip1116 = r_len1112-len1110;var if_res631 = M0.apply(M0.values,M0.append(list_take1113(results1111,skip1116-2),M0.list(M0.list_ref(results1111,M0.sub1(skip1116)),self1108),M0.__rjs_quoted__.list_tail(results1111,skip1116)));}return if_res631;}));});}return if_res633(proc1093,make_keyword_procedure(if_res632));});var if_res636 = M0.values(new_kw_proc1091,new_procedure_ref);}var if_res641 = if_res636;} else {if (okp_p(n_proc1084)!==false) {if (is_impersonator_p1034!==false) {if (okm_p(n_proc1084)!==false) {var if_res637 = make_optional_keyword_method_impersonator;} else {var if_res637 = make_optional_keyword_procedure_impersonator;}var if_res638 = if_res637(keyword_procedure_checker(n_proc1084),chaperone_procedure1036(keyword_procedure_proc(n_proc1084),kw_chaperone1045),keyword_procedure_required(n_proc1084),keyword_procedure_allowed(n_proc1084),chaperone_procedure1036(okp_ref(n_proc1084,0),okp_ref(n_wrap_proc1042,0)),n_proc1084);} else {var if_res638 = M0.__rjs_quoted__.chaperone_struct(proc1083,keyword_procedure_proc,function(self1117, proc1118) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1036(proc1118,kw_chaperone1045);},M0.make_struct_field_accessor(okp_ref,0),function(self1119, proc1120) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1036(proc1120,okp_ref(n_wrap_proc1042,0));});}var if_res640 = M0.values(if_res638,keyword_procedure_proc);} else {if (is_impersonator_p1034!==false) {var name_plus_fail1121 = keyword_procedure_name_plus_fail(n_proc1084);var mk1122 = make_required(M0.car(name_plus_fail1121),M0.cdr(name_plus_fail1121),keyword_method_p(n_proc1084),true);var if_res639 = mk1122(keyword_procedure_checker(n_proc1084),chaperone_procedure1036(keyword_procedure_proc(n_proc1084),kw_chaperone1045),keyword_procedure_required(n_proc1084),keyword_procedure_allowed(n_proc1084),n_proc1084);} else {var if_res639 = M0.__rjs_quoted__.chaperone_struct(n_proc1084,keyword_procedure_proc,function(self1123, proc1124) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1036(proc1124,kw_chaperone1045);});}var if_res640 = M0.values(if_res639,keyword_procedure_proc);}var if_res641 = if_res640;}return if_res641;};var let_result642 = wrap1082(proc1038,n_proc1041);var new_proc1080 = let_result642.getAt(0);var chap_accessor1081 = let_result642.getAt(1);if (M0.null_p(props1040)!==false) {var if_res643 = new_proc1080;} else {var if_res643 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1080,chap_accessor1081,false,props1040);}var if_res644 = if_res643;}return if_res644;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1125, name1126, proc1127, wrap_proc1128, props1129) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1130 = normalize_proc(proc1127);var n_wrap_proc1131 = normalize_proc(wrap_proc1128);var or_part1132 = M0.not(keyword_procedure_p(n_proc1130));if (or_part1132!==false) {var if_res646 = or_part1132;} else {var or_part1133 = M0.not(M0.procedure_p(wrap_proc1128));if (or_part1133!==false) {var if_res645 = or_part1133;} else {var if_res645 = bad_props_p(props1129);}var if_res646 = if_res645;}if (if_res646!==false) {var if_res647 = M0.apply(unsafe_chaperone_procedure1125,proc1127,wrap_proc1128,props1129);} else {chaperone_arity_match_checking(false,name1126,proc1127,wrap_proc1128,props1129);var if_res647 = M0.apply(unsafe_chaperone_procedure1125,proc1127,wrap_proc1128,props1129);}return if_res647;};var bad_props_p = function(props1134) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1135 = function(props1136) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1136)!==false) {var if_res650 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1136))!==false) {var props1137 = M0.cdr(props1136);var or_part1138 = M0.null_p(props1137);if (or_part1138!==false) {var if_res648 = or_part1138;} else {var if_res648 = loop1135(M0.cdr(props1137));}var if_res649 = if_res648;} else {var if_res649 = true;}var if_res650 = if_res649;}return if_res650;};return loop1135(props1134);};var chaperone_arity_match_checking = function(self_arg_p1139, name1140, proc1141, wrap_proc1142, props1143) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1144 = M0.procedure_arity(proc1141);var b1145 = M0.procedure_arity(wrap_proc1142);if (self_arg_p1139!==false) {var if_res651 = 1;} else {var if_res651 = 0;}var d1146 = if_res651;var let_result652 = procedure_keywords(proc1141);var a_req1147 = let_result652.getAt(0);var a_allow1148 = let_result652.getAt(1);var let_result653 = procedure_keywords(wrap_proc1142);var b_req1149 = let_result653.getAt(0);var b_allow1150 = let_result653.getAt(1);var includes_p1151 = function(a1152, b1153) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1153)!==false) {if (M0.number_p(a1152)!==false) {var if_res655 = M0.__eq_(b1153,a1152+d1146);} else {if (M0.arity_at_least_p(a1152)!==false) {var if_res654 = M0.__gt__eq_(b1153,M0.arity_at_least_value(a1152)+d1146);} else {var if_res654 = M0.ormap(function(a1154) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1151(a1154,b1153);},a1152);}var if_res655 = if_res654;}var if_res659 = if_res655;} else {if (M0.arity_at_least_p(b1153)!==false) {if (M0.number_p(a1152)!==false) {var if_res657 = false;} else {if (M0.arity_at_least_p(a1152)!==false) {var if_res656 = M0.__gt__eq_(M0.arity_at_least_value(b1153),M0.arity_at_least_value(a1152)+d1146);} else {var if_res656 = M0.ormap(function(a1155) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1151(b1153,a1155);},a1152);}var if_res657 = if_res656;}var if_res658 = if_res657;} else {var if_res658 = M0.andmap(function(b1156) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1151(a1152,b1156);},b1153);}var if_res659 = if_res658;}return if_res659;};if (includes_p1151(b1145,a1144)!==false) {var if_res660 = M0.rvoid();} else {var if_res660 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1141,wrap_proc1142,props1143);}if_res660;if (subset_p(b_req1149,a_req1147)!==false) {var if_res661 = M0.rvoid();} else {var if_res661 = M0.raise_arguments_error(name1140,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1142,$rjs_core.UString.make("original procedure"),proc1141);}if_res661;var or_part1157 = M0.not(b_allow1150);if (or_part1157!==false) {var if_res663 = or_part1157;} else {if (a_allow1148!==false) {var if_res662 = subset_p(a_allow1148,b_allow1150);} else {var if_res662 = false;}var if_res663 = if_res662;}if (if_res663!==false) {var if_res664 = M0.rvoid();} else {var if_res664 = M0.raise_arguments_error(name1140,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1142,$rjs_core.UString.make("original procedure"),proc1141);}if_res664;return M0.rvoid();};var normalize_proc = function(proc1158) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1158)!==false) {var if_res672 = proc1158;} else {if (new_procedure_p(proc1158)!==false) {var let_result665 = procedure_keywords(proc1158);var req_kws1159 = let_result665.getAt(0);var allowed_kws1160 = let_result665.getAt(1);if (M0.null_p(allowed_kws1160)!==false) {var if_res670 = proc1158;} else {var if_res670 = make_optional_keyword_procedure(function(given_kws1161, given_argc1162) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1158,given_argc1162-2,true)!==false) {var or_part1163 = M0.not(allowed_kws1160);if (or_part1163!==false) {var if_res667 = or_part1163;} else {var if_res667 = subset_p(given_kws1161,allowed_kws1160);}if (if_res667!==false) {var if_res668 = subset_p(req_kws1159,given_kws1161);} else {var if_res668 = false;}var if_res669 = if_res668;} else {var if_res669 = false;}return if_res669;},$rjs_core.attachProcedureArity(function(kws1164, kw_args1165, ...vals1166666) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1166 = $rjs_core.Pair.listFromArray(vals1166666);return keyword_apply(proc1158,kws1164,kw_args1165,vals1166);}),req_kws1159,allowed_kws1160,proc1158);}var if_res671 = if_res670;} else {var if_res671 = proc1158;}var if_res672 = if_res671;}return if_res672;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };